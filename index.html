<!-- Ski app that will show traffic and weather report for ski 
                        resorts in Denver area.  All viewed mountains important data 
                        will show in bottom table for comparison ---------------------->

<!doctype html>
<html lang="en">

<head>
    <!------------ Required meta tags ------------------------------------------------->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!------------ Bootstrap CSS ------------------------------------------------------->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">
    <!------------ Jquery CDN ----------------------------------------------------------->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
     <!-------------CSS---------------------------------------------------------------------->
     <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <title>Mountain Manager</title>
</head>

<body>
    
    <!------------- Dropdown menu to select mountain ----------------------------------->
    <nav class="navbar navbar-expand navbar-light bg-light">
        <a class="navbar-brand" href="#"><img src="assets/Images/MountainManager.png" /></a>
     <!--Added a zip code text box for testing weather and resort data-->   
        <input type="text" class="form-control" placeholder="Enter a Zip Code" id=txtZipCode>   
        <div class="dropdown  m-auto">
            <ul class="navbar-nav">
                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
                    Mountains
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                    <button class="dropdown-item" type="button" id="mountainSelector">Mountain</button>
                    <button class="dropdown-item" type="button" id="mountainSelector">Mountain</button>
                    <button class="dropdown-item" type="button" id="mountainSelector">Mountain</button>
                </div>
            </ul>
        </div>
    </nav>
   
    <!------------- Google map -------------------------------------------------------->
    <div class="container">
        <div class="row">
            <div class="col-sm-12 col-md-8">
                <div class="card mt-4">
                   <div class="card-body">
                         <p class="card-text text-center"> 
                            <div id="output"></div>
                            <p id="demo"></p>
                            <div id="map"></div>
                        </p>
                    </div>
                </div>
            </div>
            <script>
        // I can only make this work in the html file for some reason.
        // This is the location for Denver.
            var myCord = {lat: 39.7392, lng: -104.9903};
        // This is the location for Vail.
            var mtnCord = {lat: 39.6403, lng: -106.3742};
            function initMap(getLocation) {
              var bounds = new google.maps.LatLngBounds;
              var markersArray = [];
            //  Starting point lat/lng
              var origin = myCord;
            //  Destination lat/lng
              var destination = mtnCord;
            //  generates icons
              var destinationIcon = 'https://chart.googleapis.com/chart?' +
                  'chst=d_map_pin_letter&chld=D|FF0000|000000';
              var originIcon = 'https://chart.googleapis.com/chart?' +
                  'chst=d_map_pin_letter&chld=O|FFFF00|000000';
            // Center point lat/lng for map
              var map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: 39.5501, lng: -105.7821},
                zoom: 10
              });
    
              // Shows the traffic on the map.
              var trafficLayer = new google.maps.TrafficLayer();
              trafficLayer.setMap(map);
    
              var geocoder = new google.maps.Geocoder;
            // This code gets the distance and mode of travel.
              var service = new google.maps.DistanceMatrixService;
              service.getDistanceMatrix({
                origins: [origin],
                destinations: [destination],
                travelMode: 'DRIVING',
                unitSystem: google.maps.UnitSystem.METRIC,
                avoidHighways: false,
                avoidTolls: false
              }, function(response, status) {
                if (status !== 'OK') {
                  alert('Error was: ' + status);
                } else {
                  var originList = response.originAddresses;
                  var destinationList = response.destinationAddresses;
                  var outputDiv = document.getElementById('output');
                  outputDiv.innerHTML = '';
                  deleteMarkers(markersArray);
      
                  var showGeocodedAddressOnMap = function(asDestination) {
                    var icon = asDestination ? destinationIcon : originIcon;
                    return function(results, status) {
                      if (status === 'OK') {
                        map.fitBounds(bounds.extend(results[0].geometry.location));
                        markersArray.push(new google.maps.Marker({
                          map: map,
                          position: results[0].geometry.location,
                          icon: icon
                        }));
                      } else {
                        alert('Geocode was not successful due to: ' + status);
                      }
                    };
                  };
      
                  for (var i = 0; i < originList.length; i++) {
                    var results = response.rows[i].elements;
                    geocoder.geocode({'address': originList[i]},
                        showGeocodedAddressOnMap(false));
                    for (var j = 0; j < results.length; j++) {
                      geocoder.geocode({'address': destinationList[j]},
                          showGeocodedAddressOnMap(true));
                      outputDiv.innerHTML += originList[i] + ' to ' + destinationList[j] +
                          ': ' + results[j].distance.text + ' in ' +
                          results[j].duration.text + '<br>';
                    }
                  }
                }
              });
            }
      
            function deleteMarkers(markersArray) {
              for (var i = 0; i < markersArray.length; i++) {
                markersArray[i].setMap(null);
              }
              markersArray = [];
            }
          
          </script>
        
      
        <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBHzWlw-oxprYIXqfQALfy0P7bUMFjmyoA&callback=initMap">
        </script>
            <!-------------- Weather / Ski Resort Info --------------------------------------------------------->
            <div class="col-sm-12 col-md-4">
                <div class="card mt-4">
                    <div class="card-body">
                        <div class="container">
                            <div row>
                                <div class="col-sm">
                                    <h5 class="card-title" id="weather">Weather Forcast</h5>
                                </div>
                            </div>
                            <div row>
                                <div class="col-sm">
                                    <div id="temp"></div>
                                </div>
                            </div>
                            <div row>
                                <div class="col-sm">
                                    <div id="sky"></div>
                                </div>
                            </div>
                            <div row>
                                <div class="col-sm">
                                    <div id="wind"></div>
                                </div>
                            </div>
                        </div>
                        <div class="container">
                            <div row>
                                <div class="col-sm">
                                    <h5 class="card-title">Ski Resort Information</h5>
                                </div>
                            </div>
                            <div row>
                                <div class="col-sm">
                                    <div id="lifts"></div>
                                </div>
                            </div>
                            <div row>
                                <div class="col-sm">
                                    <div id="snowDepth"></div>
                                </div>
                            </div>
                            <div row>
                                <div class="col-sm">
                                    <div id="snowFall"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-------------- Recently viewed table ------------------------------------------->
        <div class="card mt-4" id="recentlyViewedTable">
            <div class="card-header text-dark bg-light">
                Recently Viewed
            </div>
            <div class="card-body">
                <table class="table table-responsive-sm">
                    <thead>
                        <tr>
                            <th scope="col">Mountain</th>
                            <th scope="col">ETA</th>
                            <th scope="col">Weather</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- <tr>              
                                <td>Mountain</td>
                                <td>12:50</td>
                                <td>Fair</td>
                            </tr>                        
                            <tr>              
                                <td>Mountain</td>
                                <td>13:30</td>
                                <td>Windy</td>
                            </tr>
                            <tr>              
                                <td>Mountain</td>
                                <td>14:15</td>
                                <td>Cold</td>
                            </tr>                                                   -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <video autoplay loop id="video-background" muted plays-inline>
            <source src="../MountainManager/assets/video/ski_resort.mp4">
    </video>


    <!-- Javascript, jQuery, Popper.js, Bootstrap JS ---------------------------------->
    <script src="assets/JS/app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
</body>

</html>